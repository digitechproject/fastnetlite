function activateCurrentPageLink(){const e=window.location.pathname.split("/").pop()||"index.html";let t;switch(document.querySelectorAll("#mainNavigation .nav-link").forEach((e=>{e.classList.remove("active")})),!0){case e.includes("dashboard"):t=document.getElementById("nav-dashboard");break;case e.includes("routers"):t=document.getElementById("nav-routers");break;case e.includes("stats"):t=document.getElementById("nav-stats");break;case e.includes("logs"):t=document.getElementById("nav-logs");break;case e.includes("notifications"):t=document.getElementById("nav-notifications");break;case e.includes("settings"):t=document.getElementById("nav-settings")}t&&t.classList.add("active")}function setupRouterNavigation(){console.log("Initialisation de la navigation du routeur");const e=new URLSearchParams(window.location.search);let t=e.get("routerId");if(t||(t=e.get("id")),console.log("ID du routeur détecté:",t),!t){const e=document.getElementById("routerSubNav");return e&&e.classList.add("d-none"),document.body.classList.remove("has-router-sidebar"),void document.body.classList.remove("has-router-bottom-nav")}const n=document.getElementById("routerSubNav");if(n){if(n.classList.remove("d-none"),window.innerWidth>=992){document.body.classList.add("has-router-sidebar"),document.body.classList.remove("has-router-bottom-nav"),n.classList.add("router-sidebar");const e=n.querySelector(".nav-pills");e&&(e.classList.add("flex-column"),e.classList.remove("flex-nowrap"))}else{document.body.classList.add("has-router-bottom-nav"),document.body.classList.remove("has-router-sidebar"),n.classList.remove("router-sidebar");const e=n.querySelector(".nav-pills");e&&(e.classList.remove("flex-column"),e.classList.add("flex-nowrap"))}const e={"nav-router-dashboard":`router-dashboard.html?id=${t}`,"nav-router-users":`clients.html?id=${t}`,"nav-router-wifi-codes":`wifi-codes.html?id=${t}`,"nav-router-payments":`payments.html?id=${t}`,"nav-router-settings":`router-settings.html?id=${t}`};Object.entries(e).forEach((([e,t])=>{const n=document.getElementById(e);if(n){n.href=t;const o=window.location.pathname.split("/").pop()||"index.html",a=t.split("?")[0];console.log("Comparaison de pages:",{currentPage:o,targetPage:a}),o===a&&(n.classList.add("active"),console.log("Lien activé:",e))}})),displayRouterName(t),window.addEventListener("resize",handleRouterNavResponsive)}}function handleRouterNavResponsive(){const e=document.getElementById("routerSubNav");if(!e||e.classList.contains("d-none"))return;const t=e.querySelector(".nav-pills");window.innerWidth>=992?(document.body.classList.add("has-router-sidebar"),document.body.classList.remove("has-router-bottom-nav"),e.classList.add("router-sidebar"),t&&(t.classList.add("flex-column"),t.classList.remove("flex-nowrap"))):(document.body.classList.add("has-router-bottom-nav"),document.body.classList.remove("has-router-sidebar"),e.classList.remove("router-sidebar"),t&&(t.classList.remove("flex-column"),t.classList.add("flex-nowrap")))}async function displayRouterName(e){try{console.log("Tentative d'affichage du nom du routeur:",e);const t=document.getElementById("currentRouterName");if(!t)return void console.warn("L'élément pour afficher le nom du routeur n'existe pas");if(t.textContent="Routeur "+e.substring(0,4),void 0===window.firebase||"undefined"==typeof db||"undefined"==typeof getDoc||"undefined"==typeof doc)return void console.warn("Firebase n'est pas complètement initialisé dans ce contexte");try{const n=await getDoc(doc(db,"routers",e));if(n.exists()){const o=n.data();t.textContent=o.name||"Routeur "+e.substring(0,4),console.log("Nom du routeur récupéré:",o.name)}else console.warn("Le document du routeur n'existe pas dans Firestore")}catch(e){console.error("Erreur Firebase lors de la récupération du nom du routeur:",e)}}catch(e){console.error("Erreur lors de la récupération du nom du routeur:",e)}}function setupLogoutButton(){const e=document.getElementById("navLogoutBtn");e&&e.addEventListener("click",(async e=>{e.preventDefault();try{if("undefined"==typeof auth)return void console.warn("Firebase n'est pas initialisé dans ce contexte");await signOut(auth),window.location.href="index.html"}catch(e){console.error("Erreur lors de la déconnexion:",e),alert("Erreur lors de la déconnexion. Veuillez réessayer.")}}))}function displayUserName(){const e=document.getElementById("navUserName");e&&("undefined"!=typeof auth?auth.onAuthStateChanged((t=>{e.textContent=t&&(t.displayName||t.email)||"Utilisateur"})):console.warn("Firebase n'est pas initialisé dans ce contexte"))}document.addEventListener("DOMContentLoaded",(async()=>{const e=document.getElementById("navigation-container");if(e)try{const t=await fetch("./components/navigation.html");if(!t.ok)throw new Error(`Erreur lors du chargement de la navigation: ${t.status}`);const n=await t.text();e.innerHTML=n,activateCurrentPageLink(),setupRouterNavigation(),setupLogoutButton(),displayUserName()}catch(t){console.error("Erreur lors du chargement de la navigation:",t),e.innerHTML='\n            <div class="alert alert-danger">\n                Impossible de charger la navigation. Veuillez rafraîchir la page ou contacter l\'administrateur.\n            </div>\n        '}else console.error("Conteneur de navigation non trouvé. Assurez-vous d'ajouter un div avec id='navigation-container' dans vos pages.")}));